COPYAPP	6	5	2011_11_22 10:17:51 GMT  
OC_APPL:	0	batch_ques_sel_app	9100 - editing	
	/prodcom/source/produser/sources/batch_ques_sel_app		0		1	0	2		msad_fp_start		SQL			0
CUC_ADEPEND:
	DUMMY		0	0		0
OC_RWFRAME:	1	msad_rw_gains_losses		
	msad_rw_gains_losses.rw		0		0	0	3							0
CUC_AODEPEND:
	msad_rw_gains_losses		1501	3502		0
OC_OSLPROC:	1	msad_fp_start	0	
	msad_fp_start.osq	II01msad_fp_start	-30	integer	5	0	3							0
CUC_AODEPEND:
	g_period	produser	2110	3506		0
	g_q_prev_period1	produser	2110	3506		0
	g_a_prev_period3	produser	2110	3506		0
	g_industry	produser	2110	3506		0
	g_inquiry	produser	2110	3506		0
	g_a_prev_period2	produser	2110	3506		0
	g_annual_period	produser	2110	3506		0
	g_database	produser	2110	3506		0
	g_user_id	produser	2110	3506		0
	g_a_prev_period1	produser	2110	3506		0
	g_q_prev_period3	produser	2110	3506		0
	g_q_prev_period4	produser	2110	3506		0
	g_alt_inquiry	produser	2110	3506		0
	g_alt_period	produser	2110	3506		0
	g_q_prev_period2	produser	2110	3506		0
	g_q_prev_period5	produser	2110	3506		0
	batch_check_inq_ing	produser	2050	3504		0
	batch_fp_drop_table	produser	2050	3504		0
	msa_fp_prev_periods	produser	2050	3504		0
	msad_fp_questions	produser	2050	3504		0
OC_OSLPROC:	1	msad_fp_questions	1	
	msad_fp_questions.osq	II01002msad_fp_que	-30	integer	5	0	3							0
CUC_AODEPEND:
	g_annual_period	produser	2110	3506		0
	g_industry	produser	2110	3506		0
	g_a_prev_period3	produser	2110	3506		0
	g_inquiry	produser	2110	3506		0
	g_a_prev_period1	produser	2110	3506		0
	g_a_prev_period2	produser	2110	3506		0
	g_q_prev_period3	produser	2110	3506		0
	g_q_prev_period4	produser	2110	3506		0
	g_q_prev_period2	produser	2110	3506		0
	g_q_prev_period5	produser	2110	3506		0
	g_period	produser	2110	3506		0
	g_user_id	produser	2110	3506		0
	g_q_prev_period1	produser	2110	3506		0
	batch_fp_drop_table	produser	2050	3504		0
	batch_check_inq_ing	produser	2050	3504		0
	msad_fp_atq	produser	2050	3504		0
	msad_fp_cads	produser	2050	3504		0
OC_OSLPROC:	1	msad_fp_gains_losses		
	msad_fp_gains_losses.osq	II01004msad_fp_gai	-30	integer	5	0	3							0
CUC_AODEPEND:
	g_inquiry	produser	2110	3506		0
	g_period	produser	2110	3506		0
	g_database	produser	2110	3506		0
	g_user_id	produser	2110	3506		0
	msa_cp_callsys	produser	2021	3504		0
	msa_fp_prev_periods	produser	2050	3504		0
	batch_check_inq_ing	produser	2050	3504		0
	batch_fp_drop_table	produser	2050	3504		0
OC_OSLPROC:	1	msad_fp_cads	2	
	msad_fp_cads.osq	II01003msad_fp_cad	-30	integer	5	0	3							0
CUC_AODEPEND:
	g_period	produser	2110	3506		0
	g_user_id	produser	2110	3506		0
	g_annual_period	produser	2110	3506		0
	g_industry	produser	2110	3506		0
	g_inquiry	produser	2110	3506		0
	batch_fp_drop_table	produser	2050	3504		0
	batch_check_inq_ing	produser	2050	3504		0
OC_OSLPROC:	1	msad_fp_atq		
	msad_fp_atq.osq	II01005msad_fp_atq	-30	integer	5	0	3							0
CUC_AODEPEND:
	g_industry	produser	2110	3506		0
	g_period	produser	2110	3506		0
	g_user_id	produser	2110	3506		0
	batch_check_inq_ing	produser	2050	3504		0
OC_OSLPROC:	1	msa_fp_prev_periods		
	msa_fp_prev_periods.osq	II01001msa_fp_prev	-30	integer	5	0	3							0
CUC_AODEPEND:
OC_HLPROC:	1	msa_cp_callsys		
	msa_cp_callsys.sc	msa_cp_callsys	30	integer	4	0	3	C						4
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_user_id		
			21	varchar(8)	10	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_q_prev_period5		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_q_prev_period4		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_q_prev_period3		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_q_prev_period2		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_q_prev_period1		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_period		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_inquiry		
			30	integer1	1	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_industry		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_database		
			21	varchar(10)	12	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_annual_period		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_alt_period		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_alt_inquiry		
			30	integer1	1	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_a_prev_period3		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_a_prev_period2		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_GLOBAL:	1	g_a_prev_period1		
			30	integer4	4	0	2							0
CUC_AODEPEND:
	DUMMY		0	0		0
OC_OSLPROC:	1	batch_fp_drop_table		
	batch_fp_drop_table.osq	II01000batch_fp_dr	-30	integer	5	0	3							0
CUC_AODEPEND:
	batch_check_inq_ing	produser	2050	3504		0
OC_OSLPROC:	1	batch_check_inq_ing		
	batch_check_inq_ing.osq	II01batch_check_in	-30	integer	5	0	3							0
CUC_AODEPEND:
OC_REPORT:	0	msad_rw_gains_losses		
	s	145	0	4	2
CUC_RCOMMANDS:
	ac	1	h	report	let	hline=' ____________________________________________________'+
	ac	2	h	report	let	'_____________________________________________________'+
	ac	3	h	report	let	'____________________________________________________ '
	ac	4	h	report	endlet	
	ac	5	h	report	let	vline=pad('|             |                                      ')+pad
	ac	6	h	report	let	('                                 |                   ')+pad
	ac	7	h	report	let	('                                                    |')
	ac	8	h	report	endlet	
	ac	9	h	report	format	contributor_reference(c11),contributor_industry(f5),question(f9),change(c1),user_name(c24)
	ac	10	h	report	noformfeeds	
	ac	11	h	report	pagelength	66
	ac	12	f	contributor_reference	bottom	
	ac	13	f	contributor_reference	nl	
	ac	14	f	contributor_reference	endblock	
	ac	15	f	contributor_reference	t	001
	ac	16	f	contributor_reference	pr	hline
	ac	17	f	contributor_reference	endprint	
	ac	18	f	contributor_reference	t	001
	ac	19	f	contributor_reference	pr	vline
	ac	20	f	contributor_reference	endprint	
	ac	21	f	contributor_reference	nl	
	ac	22	h	page	t	001
	ac	23	h	page	pr	current_date(d "03/02/01")
	ac	24	h	page	endprint	
	ac	25	h	page	t	152
	ac	26	h	page	pr	'Page ',page_number(f3)
	ac	27	h	page	endprint	
	ac	28	h	page	let	title='QUESTION_GAINS_AND_LOSSES_BETWEEN_'+VARCHAR($prev_period)+'_AND_'+VARCHAR($period)
	ac	29	h	page	endlet	
	ac	30	h	page	t	001
	ac	31	h	page	ul	
	ac	32	h	page	pr	title(*c159)
	ac	33	h	page	endprint	
	ac	34	h	page	noul	
	ac	35	h	page	nl	2
	ac	36	h	page	let	title='INDUSTRY'+CONCAT(' ',VARCHAR(contributor_industry))+'  COORDINATOR'+CONCAT(' ',user_name)
	ac	37	h	page	endlet	
	ac	38	h	page	t	001
	ac	39	h	page	pr	title(*c159)
	ac	40	h	page	endprint	
	ac	41	h	page	nl	2
	ac	42	h	page	t	001
	ac	43	h	page	pr	hline
	ac	44	h	page	endprint	
	ac	45	h	page	nl	
	ac	46	h	page	t	001
	ac	47	h	page	pr	vline
	ac	48	h	page	endprint	
	ac	49	h	page	nl	
	ac	50	h	page	t	001
	ac	51	h	page	pr	vline
	ac	52	h	page	endprint	
	ac	53	h	page	t	004
	ac	54	h	page	pr	'Reference'
	ac	55	h	page	endprint	
	ac	56	h	page	t	017
	ac	57	h	page	pr	'Gains'
	ac	58	h	page	endprint	
	ac	59	h	page	t	089
	ac	60	h	page	pr	'Losses'
	ac	61	h	page	endprint	
	ac	62	h	page	nl	
	ac	63	h	page	t	001
	ac	64	h	page	pr	hline
	ac	65	h	page	endprint	
	ac	66	h	page	t	001
	ac	67	h	page	pr	vline
	ac	68	h	page	endprint	
	ac	69	h	page	nl	
	ac	70	h	contributor_reference	let	stored_question=0
	ac	71	h	contributor_reference	endlet	
	ac	72	h	contributor_reference	let	stored_reference='0'
	ac	73	h	contributor_reference	endlet	
	ac	74	h	contributor_reference	if	break(contributor_industry)
	ac	75	h	contributor_reference	then	
	ac	76	h	contributor_reference	np	
	ac	77	h	contributor_reference	endif	
	ac	78	h	contributor_reference	if	line_number+need_count+2>66
	ac	79	h	contributor_reference	then	
	ac	80	h	contributor_reference	np	
	ac	81	h	contributor_reference	endif	
	ac	82	h	contributor_reference	t	001
	ac	83	h	contributor_reference	pr	vline
	ac	84	h	contributor_reference	endprint	
	ac	85	h	contributor_reference	nl	
	ac	86	h	contributor_reference	block	
	ac	87	h	contributor_reference	t	001
	ac	88	h	contributor_reference	pr	vline
	ac	89	h	contributor_reference	endprint	
	ac	90	h	contributor_reference	t	003
	ac	91	h	contributor_reference	pr	contributor_reference
	ac	92	h	contributor_reference	endprint	
	ac	93	h	contributor_reference	let	first_time_in='y'
	ac	94	h	contributor_reference	endlet	
	ac	95	h	detail	if	change='G'
	ac	96	h	detail	then	
	ac	97	h	detail	if	question/10<>stored_question/10
	ac	98	h	detail	then	
	ac	99	h	detail	if	contributor_reference=stored_reference
	ac	100	h	detail	then	
	ac	101	h	detail	nl	
	ac	102	h	detail	t	001
	ac	103	h	detail	pr	vline
	ac	104	h	detail	endprint	
	ac	105	h	detail	endif	
	ac	106	h	detail	let	counter=1
	ac	107	h	detail	endlet	
	ac	108	h	detail	endif	
	ac	109	h	detail	t	(7+10 * counter)
	ac	110	h	detail	pr	question
	ac	111	h	detail	endprint	
	ac	112	h	detail	let	counter=counter+1
	ac	113	h	detail	endlet	
	ac	114	h	detail	else	
	ac	115	h	detail	if	first_time_in='y'
	ac	116	h	detail	then	
	ac	117	h	detail	let	first_time_in='n'
	ac	118	h	detail	endlet	
	ac	119	h	detail	let	counter=1
	ac	120	h	detail	endlet	
	ac	121	h	detail	top	
	ac	122	h	detail	else	
	ac	123	h	detail	if	question/10<>stored_question/10
	ac	124	h	detail	then	
	ac	125	h	detail	if	contributor_reference=stored_reference
	ac	126	h	detail	then	
	ac	127	h	detail	nl	
	ac	128	h	detail	t	001
	ac	129	h	detail	pr	vline
	ac	130	h	detail	endprint	
	ac	131	h	detail	endif	
	ac	132	h	detail	let	counter=1
	ac	133	h	detail	endlet	
	ac	134	h	detail	endif	
	ac	135	h	detail	endif	
	ac	136	h	detail	t	(79+10 * counter)
	ac	137	h	detail	pr	question
	ac	138	h	detail	endprint	
	ac	139	h	detail	let	counter=counter+1
	ac	140	h	detail	endlet	
	ac	141	h	detail	endif	
	ac	142	h	detail	let	stored_reference=contributor_reference
	ac	143	h	detail	endlet	
	ac	144	h	detail	let	stored_question=question
	ac	145	h	detail	endlet	
	br	1		contributor_industry		contributor_reference(c11),contributor_industry(f5),question(f9),change(c1),user_name(c24)
	br	2		contributor_reference		contributor_reference(c11),contributor_industry(f5),question(f9),change(c1),user_name(c24)
	de	1		hline		c159
	de	2		vline		c159
	de	3		title		c100
	de	4		stored_reference		c11
	de	5		stored_question		i4
	de	6		counter		i4
	de	7		first_time_in		c1
	sq	1	targetlist			contributor_industry, contributor_reference, question, change, user_name, need_count
	sq	2	from			 $h_table
	sq	3	remainder			 ORDER
	sq	4	remainder			 BY contributor_industry, contributor_reference, change, question
	wd	1				160
